{% extends 'base.html.twig' %}

{% block title %}{{ 'parcours.page_title'|trans }}{% endblock %}

{% block stylesheets %}
{% endblock %}

{% block body %}
<div class="parcours-view-page">
    <div class="parcours-view-header">
        <h1>{{ course.name }}</h1>
        <h2>{{'User : '|trans}}{{user.email}}</h2>
        <span>{{'status : '|trans}}{{ course.status }}</span><br>
        <span>{{'created at : '|trans}}{{ course.createAt|date('d/m/Y') }}</span><br>
        <span>{{'updated at : '|trans}}{{ course.updateAt|date('d/m/y') }}</span><br>
        <span>
        {% if course.sameStartFinish %}
            <!-- TODO: ajouter la traduction -->
            {{ 'parcours.baliseStartFinishY'|trans}}
        {% else %}
            {{ 'parcours.baliseStartFinishN'|trans}}
        {% endif %}
        </span>
        <!-- TODO: ajouter la traduction -->
        <h2>{{ 'parcours.description'|trans }}</h2>
        <p>{{ course.description }}</p>
    </div>

    {# Map widget to display beacons/waypoints #}
    <div class="course-map-section">
        <h2>{{ 'parcours.map_view'|trans }}</h2>
        {% include 'widgets/map_widget.html.twig' with {
            'course': course,
            'showCourseInfo': true,
            'showRunnersList': false,
            'mapId': 'courseViewMap'
        } %}
    </div>
</div>


    {% block javascripts %}
        <!-- Google Maps API -->
        <script>
            function initViewMapCallback() {
                console.log('Google Maps API loaded for course view');
            }
        </script>
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBi8sXKGGafzB837kvxraWuqohlZ-JJRu8&libraries=geometry,places&callback=initViewMapCallback" async defer></script>
        
        <!-- View Map Widget Script -->
        <script src="{{ asset('assets/js/view_map.js') }}" defer></script>
        
        <!-- Load libraries from local assets (no CDN needed) -->
        <script src="{{ asset('assets/js/qrcode.min.js') }}" onload="window.qrCodeLibraryLoaded = true; console.log('QRCode library loaded from local assets');"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" data-turbo-track="reload" async onload="window.jspdfLibraryLoaded = true; console.log('jsPDF library loaded');"></script>
    {% endblock %}

{% endblock %}
