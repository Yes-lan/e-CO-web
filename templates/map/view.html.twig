{% extends 'base.html.twig' %}

{% block title %}{{ 'map.title'|trans }} - e-CO{% endblock %}

{% block body %}
<div class="map-view-container">
    <!-- Main Content: Session Selector + Runners Table + Map -->
    <div class="map-content">
        <!-- Left Column: Runners Table -->
        <div class="left-column" id="leftColumn">
            <!-- Runners Table -->
            <div class="runners-panel" id="runnersPanel">
                <h2>ðŸ‘¥ {{ 'map.runners'|trans }}</h2>
                <div class="runners-table-container">
                    <table class="runners-table">
                        <thead>
                            <tr>
                                <th>{{ 'map.runner_name'|trans }}</th>
                                <th>{{ 'map.beacons_validated'|trans }}</th>
                                <th>{{ 'map.completion_time'|trans }}</th>
                            </tr>
                        </thead>
                        <tbody id="runnersTableBody">
                            <tr>
                                <td colspan="3" class="no-data">{{ 'map.select_session_first'|trans }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Right: Google Map -->
        <div class="map-panel" id="mapPanel">
            <div id="map"></div>
        </div>
        
        <!-- Course Info Panel (shown when no session selected) -->
        <div class="course-info-panel" id="courseInfoPanel" style="display: none;">
            <h2>ðŸ“‹ {{ 'map.course_info'|trans }}</h2>
            <div id="courseInfoContent">
                <!-- Course info will be populated here -->
            </div>
        </div>
    </div>
    
    <!-- Bottom: Beacon Validation Table -->
    <div class="beacon-validation-panel" id="beaconValidationPanel">
        <div id="runnerNameBadge" class="runner-name-badge" style="display: none;"></div>
        <div class="beacon-table-container">
            <div id="beaconValidationContent" class="no-data">
                {{ 'map.select_runner_to_view'|trans }}
            </div>
        </div>
    </div>
</div>

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('assets/js/view_map.js') }}" defer></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBi8sXKGGafzB837kvxraWuqohlZ-JJRu8&libraries=geometry,places" async defer></script>
{% endblock %}
